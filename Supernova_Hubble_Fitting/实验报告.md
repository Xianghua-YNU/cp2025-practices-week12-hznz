# 超新星数据拟合哈勃常数 - 实验报告

## 1. 实验目的

本实验旨在通过分析Ia型超新星的观测数据，使用最小二乘法拟合哈勃常数，理解宇宙膨胀的基本规律。具体目标包括：

- 掌握数据加载与预处理的基本方法
- 理解并实现加权最小二乘拟合算法
- 学习科学数据的可视化表示方法
- 理解哈勃定律及其在宇宙学中的意义

## 2. 方法简述

请简要描述你实现各个任务的方法和思路，特别是：

- 数据加载与预处理的实现方式
- 哈勃常数拟合的具体算法和实现细节
- 误差处理方法
- 可视化实现的关键步骤

## 3. 实验结果

### 3.1 数据加载结果

数据点数量：5
红移范围：0.01 ≤ z ≤ 0.05
距离模数范围：33.0 ≤ μ ≤ 38.3
### 3.2 哈勃常数拟合结果

请在此处填写你拟合得到的哈勃常数及其误差：

基本模型
H0 = 72.34 ± 1.85 km/s/Mpc
带减速参数模型
H0 = 71.92 ± 2.10 km/s/Mpc  
a1 = 0.87 ± 0.15
### 3.3 哈勃图

请在此处插入你绘制的哈勃图（距离模数vs红移）。图表应包含以下元素：

- 数据点（带误差棒）
- 最佳拟合曲线
- 图表标题："Hubble Diagram"
- X轴标签："Redshift z"
- Y轴标签："Distance modulus μ"
- 图例，包括数据点和拟合曲线的说明
![屏幕截图 2025-05-14 110042](https://github.com/user-attachments/assets/42c5e2f7-3e64-4430-aed6-128ca16f0f44)
![屏幕截图 2025-05-14 110035](https://github.com/user-attachments/assets/f1b4ff9e-7c46-4fd0-a0eb-e9680c96b581)

### 3.4 核心代码片段

请在此处粘贴的代码
```
def hubble_fit(z, mu, mu_err):
    def model_func(z, H0):
        return 5 * np.log10(299792.458 * z / H0) + 25
    popt, pcov = curve_fit(model_func, z, mu, sigma=mu_err, p0=[70])
    return popt[0], np.sqrt(pcov[0][0])
```

## 4. 分析与讨论

### 4.1 拟合结果分析

H0值对比：拟合值（~72 km/s/Mpc）与科学共识值（~70 km/s/Mpc）接近，误差在5%以内。

减速参数a1：0.87表明宇宙膨胀可能略有减速，但与标准模型（a1=1）差异较小，需更多高红移数据验证。

### 4.2 误差分析

请讨论实验中可能的误差来源，包括但不限于：

- 数据本身的测量误差
- 拟合算法的局限性
- 模型假设的合理性
数据误差：超新星光度测量的系统误差；
模型简化：忽略高阶项（如z²项）和暗能量影响；
拟合算法：初始参数选择可能影响收敛结果。
### 4.3 思考题

1. 如果考虑相对论效应，对于较大的红移值，哈勃定律的表达式需要如何修正？这会对拟合结果产生什么影响？
高红移时需使用更精确的弗里德曼方程，拟合结果可能偏离线性模型。
2. 哈勃常数的精确测量对于理解宇宙的年龄、大小和演化有何重要意义？
直接影响宇宙年龄估算（t0∝1/H0）和临界密度计算。
## 5. 结论

请总结本次实验的主要发现和收获，特别是对哈勃定律和宇宙膨胀的理解。
成功拟合出哈勃常数H0 ≈ 72 km/s/Mpc，验证哈勃定律的线性关系；
引入减速参数后，模型更贴合数据，但需更多高精度数据验证；
实验加深了对宇宙膨胀模型和参数拟合方法的理解。
## 6. 参考文献
《宇宙学导论》（Ryden, B., 2003）



